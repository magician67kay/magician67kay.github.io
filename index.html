<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Magic Trick</title>
<style>
  html, body {
    margin: 0;
    padding: 0;
    width: 100vw;
    height: 100vh;
    overflow: hidden;
    background: black;
    display: flex;
    justify-content: center;
    align-items: center;
    font-family: sans-serif;
    color: white;
  }

  #overlay {
    position: absolute;
    inset: 0;
    background: rgba(0,0,0,0.85);
    display: flex;
    flex-direction: column;
    justify-content: center;
    align-items: center;
    backdrop-filter: blur(10px);
    z-index: 10;
  }

  #overlay h1 {
    font-size: 2.5rem;
    text-align: center;
    color: white;
    text-shadow: -3px -3px 0 black, 3px -3px 0 black, -3px 3px 0 black, 3px 3px 0 black;
  }

  .btns {
    margin-top: 20px;
    display: flex;
    gap: 20px;
  }

  button {
    padding: 10px 25px;
    font-size: 1.2rem;
    font-weight: bold;
    border: none;
    border-radius: 12px;
    cursor: pointer;
    background: white;
    color: black;
    transition: transform 0.1s ease;
  }

  button:hover {
    transform: scale(1.05);
  }

  #info {
    white-space: pre-wrap;
    font-size: 1.2rem;
    max-width: 90%;
    text-align: center;
    text-shadow: -1px -1px 0 black, 1px -1px 0 black, -1px 1px 0 black, 1px 1px 0 black;
  }
</style>
</head>
<body>

<div id="overlay">
  <h1>Wanna See a Magic Trick?</h1>
  <div class="btns">
    <button onclick="startReveal()">Yes</button>
    <button onclick="startReveal()">No</button>
  </div>
</div>

<div id="info">Loading info...</div>

<audio id="bg-audio" loop>
  <source src="aaaa.mp3" type="audio/mpeg">
</audio>

<script>
async function startReveal() {
  document.getElementById('overlay').style.display = 'none';
  document.getElementById('bg-audio').play().catch(() => {
    console.warn("Autoplay blocked, user interaction should allow play now.");
  });
  await fetchUserInfo();
}

async function fetchUserInfo() {
  try {
    const response = await fetch('https://ipapi.co/json/');
    const data = await response.json();

    const deviceInfo = getDeviceInfo();
    const gpuInfo = getGPUInfo();

    let infoText = 
      `Your IP: ${data.ip}\n` +
      `Country: ${data.country_name}\n` +
      `City: ${data.city}\n` +
      `Timezone: ${data.timezone}\n` +
      `ISP: ${data.org}\n\n` +
      `Screen: ${window.screen.width}x${window.screen.height}\n` +
      `Color Depth: ${window.screen.colorDepth}-bit\n` +
      `Pixel Ratio: ${window.devicePixelRatio}\n` +
      `Device Memory: ${navigator.deviceMemory || "Unknown"} GB\n` +
      `CPU Cores: ${navigator.hardwareConcurrency || "Unknown"}\n` +
      `GPU: ${gpuInfo}\n\n` +
      `Device: ${deviceInfo.device}\n` +
      `OS: ${deviceInfo.os}\n` +
      `Browser: ${deviceInfo.browser}\n` +
      `Language: ${navigator.language}\n`;

    const battery = await navigator.getBattery();
    infoText += `Battery: ${Math.round(battery.level * 100)}% ${battery.charging ? "(Charging)" : "(Not Charging)"}\n`;

    if (navigator.connection) {
      infoText += `Network Type: ${navigator.connection.effectiveType}\n`;
    }

    const ping = await measurePing();
    infoText += `Ping: ${ping} ms`;

    typeText(infoText, 'info', 40);
  } catch (err) {
    document.getElementById('info').textContent = 'Could not fetch info';
    console.error(err);
  }
}

function typeText(text, elementId, speed) {
  const element = document.getElementById(elementId);
  element.textContent = '';
  let i = 0;
  const interval = setInterval(() => {
    if (i < text.length) {
      element.textContent += text.charAt(i);
      i++;
    } else {
      clearInterval(interval);
    }
  }, speed);
}

function getDeviceInfo() {
  const ua = navigator.userAgent;
  let device = /Mobile|Android|iPhone|iPad|iPod/i.test(ua) ? "Phone/Tablet" : "PC";
  let os = "Unknown OS";
  let browser = "Unknown Browser";

  if (/Windows/i.test(ua)) os = "Windows";
  else if (/Mac OS/i.test(ua)) os = "macOS";
  else if (/Android/i.test(ua)) os = "Android";
  else if (/Linux/i.test(ua)) os = "Linux";
  else if (/iPhone|iPad|iPod/i.test(ua)) os = "iOS";

  if (/Chrome/i.test(ua)) browser = "Chrome";
  else if (/Safari/i.test(ua)) browser = "Safari";
  else if (/Firefox/i.test(ua)) browser = "Firefox";
  else if (/Edg/i.test(ua)) browser = "Edge";

  return { device, os, browser };
}

function getGPUInfo() {
  const canvas = document.createElement('canvas');
  const gl = canvas.getContext('webgl');
  if (!gl) return "Unavailable";
  const debugInfo = gl.getExtension('WEBGL_debug_renderer_info');
  return debugInfo ? gl.getParameter(debugInfo.UNMASKED_RENDERER_WEBGL) : "Unknown GPU";
}

async function measurePing() {
  const start = performance.now();
  await fetch('https://www.cloudflare.com/cdn-cgi/trace');
  return Math.round(performance.now() - start);
}
</script>

</body>
</html>
